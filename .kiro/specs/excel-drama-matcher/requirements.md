# 需求文档

## 简介

Excel剧名匹配工具：一个命令行工具，用于读取两个Excel文档（A文档为主表，B文档为查找列表）。两个文档均包含多列数据，剧名只是其中一列。用户需要指定剧名所在的列，工具在A文档中查找所有出现在B文档中的剧名，并将匹配的剧名单元格所在行标记颜色高亮，最终输出标记后的Excel文件。

## 术语表

- **A文档（Master_File）**：包含多列数据的Excel主表文件，其中一列为剧名，包含几千条记录
- **B文档（Lookup_File）**：包含多列数据的Excel文件，其中一列为需要查找的剧名
- **剧名列（Drama_Column）**：用户指定的包含剧名数据的列标识（列名或列号）
- **匹配器（Matcher）**：负责比对A文档和B文档中剧名的核心组件
- **高亮标记器（Highlighter）**：负责将匹配到的单元格标记颜色的组件
- **剧名（Drama_Name）**：Excel单元格中的文本内容，代表一部剧的名称

## 需求

### 需求 1：读取Excel文件

**用户故事：** 作为用户，我希望工具能读取A文档和B文档的Excel文件，并让我指定剧名所在的列，以便后续进行剧名匹配。

#### 验收标准

1. WHEN 用户提供A文档路径、B文档路径以及各自的剧名列标识, THE Matcher SHALL 读取两个Excel文件并从指定列中解析剧名数据
2. WHEN 用户提供的文件路径不存在, THE Matcher SHALL 返回明确的文件未找到错误信息，包含具体的文件路径
3. WHEN 用户提供的文件不是有效的Excel格式（.xlsx 或 .xls）, THE Matcher SHALL 返回明确的格式错误信息
4. WHEN 用户指定的列标识在Excel文件中不存在, THE Matcher SHALL 返回明确的列未找到错误信息
5. WHEN Excel文件中指定列存在空行或空单元格, THE Matcher SHALL 跳过空值并继续处理其余数据

### 需求 2：剧名匹配

**用户故事：** 作为用户，我希望工具能在A文档中找出所有在B文档中出现的剧名，以便我知道哪些剧名是重复的。

#### 验收标准

1. WHEN A文档和B文档的剧名列数据加载完成, THE Matcher SHALL 将B文档指定列中的所有剧名与A文档指定列中的剧名逐一比对
2. WHEN A文档中的某个剧名与B文档中的某个剧名完全一致（去除首尾空格后）, THE Matcher SHALL 将该剧名标记为匹配
3. WHEN A文档中不存在任何与B文档匹配的剧名, THE Matcher SHALL 输出提示信息告知用户未找到匹配项
4. THE Matcher SHALL 在匹配完成后输出匹配到的剧名数量

### 需求 3：高亮标记

**用户故事：** 作为用户，我希望匹配到的剧名在A文档中被颜色高亮标记，以便我能直观地看到哪些剧名出现在B文档中。

#### 验收标准

1. WHEN 匹配完成后, THE Highlighter SHALL 将A文档中所有匹配到的剧名单元格所在整行的背景色设置为黄色（#FFFF00）
2. WHEN 对行进行高亮标记时, THE Highlighter SHALL 保留单元格原有的其他格式（如字体、字号、边框）
3. THE Highlighter SHALL 仅修改匹配到的行，未匹配的行保持原样不变

### 需求 4：保存结果

**用户故事：** 作为用户，我希望工具直接在A文档原文件上标记并保存，不生成新文件，以便我直接查看结果。

#### 验收标准

1. WHEN 高亮标记完成后, THE Matcher SHALL 将标记后的A文档直接保存到原文件路径（覆盖原文件）
2. WHEN 保存成功, THE Matcher SHALL 输出匹配统计信息（匹配数量、A文档总数量）

### 需求 5：数据序列化与反序列化

**用户故事：** 作为用户，我希望工具能正确地读取和写入Excel文件数据，确保数据在处理过程中不丢失或损坏。

#### 验收标准

1. WHEN 读取Excel文件中的剧名数据, THE Matcher SHALL 将单元格内容解析为字符串列表
2. WHEN 写入标记后的Excel文件, THE Matcher SHALL 确保写入的文件可被Excel软件正常打开
3. FOR ALL 有效的剧名数据, 读取后再写入（不做任何修改）SHALL 产生与原始数据等价的结果（往返一致性）
